{% extends 'base.html' %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å {{ username }}{% endblock %}

{% block content %}
    <h1>–ü—Ä–æ—Ñ–∏–ª—å {{ username }}</h1>
    <div class="profile-info">
        <img src="{{ url_for('static', filename='avatar.png') }}" alt="–ê–≤–∞—Ç–∞—Ä" class="avatar">
        <div class="description">
            <h2>–û–ø–∏—Å–∞–Ω–∏–µ</h2>
            <p>–¢–µ–∫—Å—Ç –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {{ username }}</p>
        </div>
        <div class="services">
            <h2>–í–∏–¥ —É—Å–ª—É–≥</h2>
            <p>–¢–µ–∫—Å—Ç –≤–∏–¥–∞ —É—Å–ª—É–≥</p>
        </div>
    </div>
    <button onclick="window.location.href='{{ url_for('subscribe', username=username) }}'">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
    <button onclick="toggleMessageForm()">–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
    <form id="message-form" class="message-form" action="{{ url_for('send_message', username=username) }}" method="post">
        <textarea id="message-text" name="message_text" rows="4" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–¥–µ—Å—å..." required></textarea>
        <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </form>
    <h2>–ü–æ—Å—Ç—ã</h2>
    {% for post in posts %}
        <div class="post">
            <h2>{{ post.title }}</h2>
            <p>{{ post.content }}</p>
            <p><strong>–ê–≤—Ç–æ—Ä:</strong> <a href="{{ url_for('user_profile', username=post.author) }}">{{ post.author }}</a></p>
            <p><strong>–î–∞—Ç–∞:</strong> {{ post.date }}</p>
            <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:</h3>
            {% for comment in post.comments %}
                <div class="comment">
                    <p><strong>{{ comment.author }}:</strong> {{ comment.text }}</p>
                </div>
            {% endfor %}
            <form action="{{ url_for('add_comment', post_id=post.id) }}" method="post">
                <label for="comment_text">–û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</label>
                <input type="text" id="comment_text" name="comment_text" required>
                <input type="hidden" name="comment_author" value="–ì–æ—Å—Ç—å">
                <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </form>
            <h3>–†–µ–∞–∫—Ü–∏–∏:</h3>
            <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∞–∫—Ü–∏–π:</strong> {{ post.reactions }}</p>
            <form action="{{ url_for('add_reaction', post_id=post.id) }}" method="post">
                <button type="submit" name="reaction" value="üòä">üòä</button>
                <button type="submit" name="reaction" value="üëç">üëç</button>
                <button type="submit" name="reaction" value="‚ù§Ô∏è">‚ù§Ô∏è</button>
            </form>
        </div>
    {% endfor %}
    <script>
        function toggleMessageForm() {
            const messageForm = document.getElementById('message-form');
            messageForm.style.display = messageForm.style.display === 'block' ? 'none' : 'block';
        }
    </script>
{% endblock %}
